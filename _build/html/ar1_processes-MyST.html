

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>AR1 Processes &#8212; MyST Example Project  documentation</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    <link rel="stylesheet" href="_static/sphinx-bootstrap.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link href="_static/css/theme.css" rel="stylesheet">
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Dynamics in One Dimension" href="scalar_dynam-MyST.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main">

<a class="navbar-brand" href="index.html">
  <img src="_static/logo.png" class="logo" alt="logo">
</a>

<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-menu" aria-controls="navbar-menu" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
</button>

<div id="navbar-menu" class="collapse navbar-collapse">
  <ul id="navbar-main-elements" class="navbar-nav mr-auto">
    <li class="nav-item">
        <a class="nav-link" href="index.html">Home</a>
    </li>
    
    
    <li class="nav-item ">
        <a class="nav-link" href="scalar_dynam-MyST.html"> Dynamics in One Dimension</a>
    </li>
    
    <li class="nav-item active">
        <a class="nav-link" href="">AR1 Processes</a>
    </li>
    
    
  </ul>
  <ul class="navbar-nav ml-auto">
    
    
  </ul>
</div>
    </nav>

    <div class="container-fluid">
      <div class="row flex-xl-nowrap">
          <div class="col-12 col-md-3 col-xl-2 bd-sidebar">

<form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">

  <div class="bd-toc-item active">
  

  <ul class="nav bd-sidenav">
      
      
      
      
        
      
      
    </ul>

</nav>
          </div>

          <div class="d-none d-xl-block col-xl-2 bd-toc">
              


<div class="tocsection onthispage"><i class="fas fa-list"></i> On this page</div>
<nav id="bd-toc-nav">
    <ul class="nav section-nav flex-column">
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#overview" class="nav-link">Overview</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#the-ar-1-model" class="nav-link">The AR(1) Model</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h3">
            <a href="#moving-average-representation" class="nav-link">Moving Average Representation</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#distribution-dynamics" class="nav-link">Distribution Dynamics</a>
        </li>
    
            </ul>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#stationarity-and-asymptotic-stability" class="nav-link">Stationarity and Asymptotic Stability</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h3">
            <a href="#stationary-distributions" class="nav-link">Stationary Distributions</a>
        </li>
    
            </ul>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#ergodicity" class="nav-link">Ergodicity</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#exercises" class="nav-link">Exercises</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h3">
            <a href="#exercise-1" class="nav-link">Exercise 1</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#exercise-2" class="nav-link">Exercise 2</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#exercise-3" class="nav-link">Exercise 3</a>
        </li>
    
            </ul>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#solutions" class="nav-link">Solutions</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h3">
            <a href="#id2" class="nav-link">Exercise 1</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#id3" class="nav-link">Exercise 2</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#id4" class="nav-link">Exercise 3</a>
        </li>
    
            </ul>
        </li>
    
    </ul>
</nav>
              
            </div>

          <main class="col-12 col-md-9 col-xl-8 py-md-3 pl-md-5 bd-content" role="main">
              <div>
                
  <div class="section" id="ar1-processes">
<h1><a class="toc-backref" href="#id5">AR1 Processes</a><a class="headerlink" href="#ar1-processes" title="Permalink to this headline">¶</a></h1>
<div class="contents topic" id="contents">
<p class="topic-title">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#ar1-processes" id="id5">AR1 Processes</a></p>
<ul>
<li><p><a class="reference internal" href="#overview" id="id6">Overview</a></p></li>
<li><p><a class="reference internal" href="#the-ar-1-model" id="id7">The AR(1) Model</a></p></li>
<li><p><a class="reference internal" href="#stationarity-and-asymptotic-stability" id="id8">Stationarity and Asymptotic Stability</a></p></li>
<li><p><a class="reference internal" href="#ergodicity" id="id9">Ergodicity</a></p></li>
<li><p><a class="reference internal" href="#exercises" id="id10">Exercises</a></p></li>
<li><p><a class="reference internal" href="#solutions" id="id11">Solutions</a></p></li>
</ul>
</li>
</ul>
</div>
<p>If you haven’t already, check out our <a class="reference internal" href="scalar_dynam-MyST.html#scalar-d"><span class="std std-ref">earlier lecture</span></a> on
dynamics.</p>
<div class="section" id="overview">
<h2><a class="toc-backref" href="#id6">Overview</a><a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>In this lecture we are going to study a very simple class of stochastic
models called AR(1) processes.</p>
<p>These simple models are used again and again in economic research to
represent the dynamics of series such as</p>
<ul class="simple">
<li><p>labor income</p></li>
<li><p>dividends</p></li>
<li><p>productivity, etc.</p></li>
</ul>
<p>AR(1) processes can take negative values but are easily converted into
positive processes when necessary by a transformation such as
exponentiation.</p>
<p>We are going to study AR(1) processes partly because they are useful and
partly because they help us understand important concepts.</p>
<p>Let’s start with some imports:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
<div class="section" id="the-ar-1-model">
<h2><a class="toc-backref" href="#id7">The AR(1) Model</a><a class="headerlink" href="#the-ar-1-model" title="Permalink to this headline">¶</a></h2>
<p>The <strong>AR(1) model</strong> (autoregressive model of order 1) takes the form</p>
<div class="math notranslate nohighlight" id="equation-can-ar1">
<span class="eqno">(1)<a class="headerlink" href="#equation-can-ar1" title="Permalink to this equation">¶</a></span>\[X_{t+1} = a X_t + b + c W_{t+1}\]</div>
<p>where <span class="math notranslate nohighlight">\(a, b, c\)</span> are scalar-valued parameters.</p>
<p>This law of motion generates a time series <span class="math notranslate nohighlight">\(\{ X_t\}\)</span> as soon as we
specify an initial condition <span class="math notranslate nohighlight">\(X_0\)</span>.</p>
<p>This is called the <strong>state process</strong> and the state space is <span class="math notranslate nohighlight">\(\mathbb R\)</span>.</p>
<p>To make things even simpler, we will assume that</p>
<ul class="simple">
<li><p>the process <span class="math notranslate nohighlight">\(\{ W_t \}\)</span> is IID and standard normal,</p></li>
<li><p>the initial condition <span class="math notranslate nohighlight">\(X_0\)</span> is drawn from the normal distribution
<span class="math notranslate nohighlight">\(N(\mu_0, v_0)\)</span> and</p></li>
<li><p>the initial condition <span class="math notranslate nohighlight">\(X_0\)</span> is independent of <span class="math notranslate nohighlight">\(\{ W_t \}\)</span>.</p></li>
</ul>
<div class="section" id="moving-average-representation">
<h3>Moving Average Representation<a class="headerlink" href="#moving-average-representation" title="Permalink to this headline">¶</a></h3>
<p>Iterating backwards from time <span class="math notranslate nohighlight">\(t\)</span>, we obtain</p>
<p><div class="math notranslate nohighlight">
\[X_t = a X_{t-1} + b +  c W_t 
= a^2 X_{t-2} + a b + a c W_{t-1} + b + c W_t 
= \cdots\]</div>
</p>
<p>If we work all the way back to time zero, we get</p>
<div class="math notranslate nohighlight" id="equation-ar1-ma">
<span class="eqno">(2)<a class="headerlink" href="#equation-ar1-ma" title="Permalink to this equation">¶</a></span>\[X_t = a^t X_0 + b \sum_{j=0}^{t-1} a^j +
     c \sum_{j=0}^{t-1} a^j  W_{t-j}\]</div>
<p>Equation <a class="reference internal" href="#equation-ar1-ma">(2)</a> shows that <span class="math notranslate nohighlight">\(X_t\)</span> is a
well defined random variable, the value of which depends on</p>
<ul class="simple">
<li><p>the parameters,</p></li>
<li><p>the initial condition <span class="math notranslate nohighlight">\(X_0\)</span> and</p></li>
<li><p>the shocks <span class="math notranslate nohighlight">\(W_1, \ldots W_t\)</span> from time <span class="math notranslate nohighlight">\(t=1\)</span> to the present.</p></li>
</ul>
<p>Throughout, the symbol <span class="math notranslate nohighlight">\(\psi_t\)</span> will be used to refer to the density of
this random variable <span class="math notranslate nohighlight">\(X_t\)</span>.</p>
</div>
<div class="section" id="distribution-dynamics">
<h3>Distribution Dynamics<a class="headerlink" href="#distribution-dynamics" title="Permalink to this headline">¶</a></h3>
<p>One of the nice things about this model is that it’s so easy to trace
out the sequence of distributions <span class="math notranslate nohighlight">\(\{ \psi_t \}\)</span> corresponding to the
time series <span class="math notranslate nohighlight">\(\{ X_t\}\)</span>.</p>
<p>To see this, we first note that <span class="math notranslate nohighlight">\(X_t\)</span> is normally distributed for each
<span class="math notranslate nohighlight">\(t\)</span>.</p>
<p>This is immediate form <a class="reference internal" href="#equation-ar1-ma">(2)</a>, since
linear combinations of independent normal random variables are normal.</p>
<p>Given that <span class="math notranslate nohighlight">\(X_t\)</span> is normally distributed, we will know the full
distribution <span class="math notranslate nohighlight">\(\psi_t\)</span> if we can pin down its first two moments.</p>
<p>Let <span class="math notranslate nohighlight">\(\mu_t\)</span> and <span class="math notranslate nohighlight">\(v_t\)</span> denote the mean and variance of <span class="math notranslate nohighlight">\(X_t\)</span>
respectively.</p>
<p>We can pin down these values from <a class="reference internal" href="#equation-ar1-ma">(2)</a>
or we can use the following recursive expressions:</p>
<div class="math notranslate nohighlight" id="equation-dyn-tm">
<span class="eqno">(3)<a class="headerlink" href="#equation-dyn-tm" title="Permalink to this equation">¶</a></span>\[\mu_{t+1} = a \mu_t + b
\quad \text{and} \quad
v_{t+1} = a^2 v_t + c^2\]</div>
<p>These expressions are obtained from <a class="reference internal" href="#equation-can-ar1">(1)</a> by taking,
respectively, the expectation and variance of both sides of the
equality.</p>
<p>In calculating the second expression, we are using the fact that <span class="math notranslate nohighlight">\(X_t\)</span>
and <span class="math notranslate nohighlight">\(W_{t+1}\)</span> are independent.</p>
<p>(This follows from our assumptions and <a class="reference internal" href="#equation-ar1-ma">(2)</a>.)</p>
<p>Given the dynamics in <a class="reference internal" href="#equation-ar1-ma">(2)</a> and initial
conditions <span class="math notranslate nohighlight">\(\mu_0,
v_0\)</span>, we obtain <span class="math notranslate nohighlight">\(\mu_t, v_t\)</span> and hence</p>
<p><div class="math notranslate nohighlight">
\[\psi_t = N(\mu_t, v_t)\]</div>
</p>
<p>The following code uses these facts to track the sequence of marginal
distributions <span class="math notranslate nohighlight">\(\{ \psi_t \}\)</span>.</p>
<p>The parameters are</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.5</span>

<span class="n">mu</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="o">-</span><span class="mf">3.0</span><span class="p">,</span> <span class="mf">0.6</span>  <span class="c1"># initial conditions mu_0, v_0</span>
</pre></div>
</div>
<p>Here’s the sequence of distributions:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">norm</span>

<span class="n">sim_length</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">120</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">sim_length</span><span class="p">):</span>
    <span class="n">mu</span> <span class="o">=</span> <span class="n">a</span> <span class="o">*</span> <span class="n">mu</span> <span class="o">+</span> <span class="n">b</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">a</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">v</span> <span class="o">+</span> <span class="n">c</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">mu</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">v</span><span class="p">)),</span> 
            <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;$\psi_</span><span class="si">{t}</span><span class="s2">$&quot;</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">[</span><span class="mf">1.05</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">loc</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">borderaxespad</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="stationarity-and-asymptotic-stability">
<h2><a class="toc-backref" href="#id8">Stationarity and Asymptotic Stability</a><a class="headerlink" href="#stationarity-and-asymptotic-stability" title="Permalink to this headline">¶</a></h2>
<p>Notice that, in the figure above, the sequence <span class="math notranslate nohighlight">\(\{ \psi_t \}\)</span> seems to
be converging to a limiting distribution.</p>
<p>This is even clearer if we project forward further into the future:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_density_seq</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">mu_0</span><span class="o">=-</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">v_0</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">sim_length</span><span class="o">=</span><span class="mi">60</span><span class="p">):</span>
    <span class="n">mu</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">mu_0</span><span class="p">,</span> <span class="n">v_0</span>
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">sim_length</span><span class="p">):</span>
        <span class="n">mu</span> <span class="o">=</span> <span class="n">a</span> <span class="o">*</span> <span class="n">mu</span> <span class="o">+</span> <span class="n">b</span>
        <span class="n">v</span> <span class="o">=</span> <span class="n">a</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">v</span> <span class="o">+</span> <span class="n">c</span><span class="o">**</span><span class="mi">2</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> 
                <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">mu</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">v</span><span class="p">)),</span>  
                <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">plot_density_seq</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>Moreover, the limit does not depend on the initial condition.</p>
<p>For example, this alternative density sequence also converges to the
same limit.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">plot_density_seq</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">mu_0</span><span class="o">=</span><span class="mf">3.0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>In fact it’s easy to show that such convergence will occur, regardless
of the initial condition, whenever <span class="math notranslate nohighlight">\(|a| &lt; 1\)</span>.</p>
<p>To see this, we just have to look at the dynamics of the first two
moments, as given in <a class="reference internal" href="#equation-dyn-tm">(3)</a>.</p>
<p>When <span class="math notranslate nohighlight">\(|a| &lt; 1\)</span>, these sequences converge to the respective limits</p>
<div class="math notranslate nohighlight" id="equation-mu-sig-star">
<span class="eqno">(4)<a class="headerlink" href="#equation-mu-sig-star" title="Permalink to this equation">¶</a></span>\[\mu^* := \frac{b}{1-a}
\quad \text{and} \quad
v^* = \frac{c^2}{1 - a^2}\]</div>
<p>Hence</p>
<div class="math notranslate nohighlight" id="equation-ar1-psi-star">
<span class="eqno">(5)<a class="headerlink" href="#equation-ar1-psi-star" title="Permalink to this equation">¶</a></span>\[\psi_t \to \psi^* = N(\mu^*, v^*)
\quad \text{as }
t \to \infty\]</div>
<p>We can confirm this is valid for the sequence above using the following
code.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">plot_density_seq</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">mu_0</span><span class="o">=</span><span class="mf">3.0</span><span class="p">)</span>

<span class="n">mu_star</span> <span class="o">=</span> <span class="n">b</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">a</span><span class="p">)</span>
<span class="n">std_star</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">c</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>  <span class="c1"># square root of v_star</span>
<span class="n">psi_star</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">mu_star</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">std_star</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">psi_star</span><span class="p">,</span> <span class="s1">&#39;k-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;$\psi^*$&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>As claimed, the sequence <span class="math notranslate nohighlight">\(\{ \psi_t \}\)</span> converges to <span class="math notranslate nohighlight">\(\psi^*\)</span>.</p>
<div class="section" id="stationary-distributions">
<h3>Stationary Distributions<a class="headerlink" href="#stationary-distributions" title="Permalink to this headline">¶</a></h3>
<p>A stationary distribution is a distribution that is a fixed point of
the update rule for distributions.</p>
<p>In other words, if <span class="math notranslate nohighlight">\(\psi_t\)</span> is stationary, then <span class="math notranslate nohighlight">\(\psi_{t+j} =
\psi_t\)</span> for all <span class="math notranslate nohighlight">\(j\)</span> in <span class="math notranslate nohighlight">\(\mathbb N\)</span>.</p>
<p>A different way to put this, specialized to the current setting, is as
follows: a density <span class="math notranslate nohighlight">\(\psi\)</span> on <span class="math notranslate nohighlight">\(\mathbb R\)</span> is <strong>stationary</strong> for the
AR(1) process if</p>
<p><div class="math notranslate nohighlight">
\[X_t \sim \psi
\quad \implies \quad 
a X_t + b + c W_{t+1} \sim \psi\]</div>
</p>
<p>The distribution <span class="math notranslate nohighlight">\(\psi^*\)</span> in <a class="reference internal" href="#equation-ar1-psi-star">(5)</a>
has this property ---checking this is an exercise.</p>
<p>(Of course, we are assuming that <span class="math notranslate nohighlight">\(|a| &lt; 1\)</span> so that <span class="math notranslate nohighlight">\(\psi^*\)</span> is well
defined.)</p>
<p>In fact, it can be shown that no other distribution on <span class="math notranslate nohighlight">\(\mathbb R\)</span> has
this property.</p>
<p>Thus, when <span class="math notranslate nohighlight">\(|a| &lt; 1\)</span>, the AR(1) model has exactly one stationary density
and that density is given by <span class="math notranslate nohighlight">\(\psi^*\)</span>.</p>
</div>
</div>
<div class="section" id="ergodicity">
<h2><a class="toc-backref" href="#id9">Ergodicity</a><a class="headerlink" href="#ergodicity" title="Permalink to this headline">¶</a></h2>
<p>The concept of ergodicity is used in different ways by different
authors.</p>
<p>One way to understand it in the present setting is that a version of
the Law of Large Numbers is valid for <span class="math notranslate nohighlight">\(\{X_t\}\)</span>, even though it is not
IID.</p>
<p>In particular, averages over time series converge to expectations under
the stationary distribution.</p>
<p>Indeed, it can be proved that, whenever <span class="math notranslate nohighlight">\(|a| &lt; 1\)</span>, we have</p>
<div class="math notranslate nohighlight" id="equation-ar1-ergo">
<span class="eqno">(6)<a class="headerlink" href="#equation-ar1-ergo" title="Permalink to this equation">¶</a></span>\[\frac{1}{m} \sum_{t = 1}^m h(X_t)  \to 
\int h(x) \psi^*(x) dx
    \quad \text{as } m \to \infty\]</div>
<p>whenever the integral on the right hand side is finite and well defined.</p>
<p>Notes:</p>
<ul class="simple">
<li><p>In <a class="reference internal" href="#equation-ar1-ergo">(6)</a>, convergence holds with
probability one.</p></li>
<li><p>The textbook by <a class="bibtex reference internal" href="#meyntweedie2009" id="id1">[MT09]</a> is
a classic reference on ergodicity.</p></li>
</ul>
<p>For example, if we consider the identity function <span class="math notranslate nohighlight">\(h(x) = x\)</span>, we get</p>
<p><div class="math notranslate nohighlight">
\[\frac{1}{m} \sum_{t = 1}^m X_t  \to 
\int x \psi^*(x) dx
\quad \text{as } m \to \infty\]</div>
</p>
<p>In other words, the time series sample mean converges to the mean of the
stationary distribution.</p>
<p>As will become clear over the next few lectures, ergodicity is a very
important concept for statistics and simulation.</p>
</div>
<div class="section" id="exercises">
<h2><a class="toc-backref" href="#id10">Exercises</a><a class="headerlink" href="#exercises" title="Permalink to this headline">¶</a></h2>
<div class="section" id="exercise-1">
<h3>Exercise 1<a class="headerlink" href="#exercise-1" title="Permalink to this headline">¶</a></h3>
<p>Let <span class="math notranslate nohighlight">\(k\)</span> be a natural number.</p>
<p>The <span class="math notranslate nohighlight">\(k\)</span>-th central moment of a random variable is defined as</p>
<p><div class="math notranslate nohighlight">
\[M_k := \mathbb E [ (X - \mathbb E X )^k ]\]</div>
</p>
<p>When that random variable is <span class="math notranslate nohighlight">\(N(\mu, \sigma^2)\)</span>, it is known that</p>
<p><div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
M_k = 
\begin{cases}
0 &amp; \text{ if } k \text{ is odd} \\
\sigma^k (k-1)!! &amp; \text{ if } k \text{ is even} 
\end{cases}
\end{aligned}\end{split}\]</div>
</p>
<p>Here <span class="math notranslate nohighlight">\(n!!\)</span> is the double factorial.</p>
<p>According to <a class="reference internal" href="#equation-ar1-ergo">(6)</a>, we should have,
for any <span class="math notranslate nohighlight">\(k \in \mathbb N\)</span>,</p>
<p><div class="math notranslate nohighlight">
\[\frac{1}{m} \sum_{t = 1}^m 
(X_t - \mu^* )^k
\approx M_k\]</div>
</p>
<p>when <span class="math notranslate nohighlight">\(m\)</span> is large.</p>
<p>Confirm this by simulation at a range of <span class="math notranslate nohighlight">\(k\)</span> using the default
parameters from the lecture.</p>
</div>
<div class="section" id="exercise-2">
<h3>Exercise 2<a class="headerlink" href="#exercise-2" title="Permalink to this headline">¶</a></h3>
<p>Write your own version of a one dimensional
<a class="reference external" href="https://en.wikipedia.org/wiki/Kernel_density_estimation">kernel density estimator</a>,
which estimates a density from a sample.</p>
<p>Write it as a class that takes the data <span class="math notranslate nohighlight">\(X\)</span> and bandwidth <span class="math notranslate nohighlight">\(h\)</span> when
initialized and provides a method <span class="math notranslate nohighlight">\(f\)</span> such that</p>
<p><div class="math notranslate nohighlight">
\[f(x) = \frac{1}{hn} \sum_{i=1}^n 
K \left( \frac{x-X_i}{h} \right)\]</div>
</p>
<p>For <span class="math notranslate nohighlight">\(K\)</span> use the Gaussian kernel (<span class="math notranslate nohighlight">\(K\)</span> is the standard normal density).</p>
<p>Write the class so that the bandwidth defaults to Silverman’s rule (see
the “rule of thumb” discussion on
<a class="reference external" href="https://en.wikipedia.org/wiki/Kernel_density_estimation">this page</a>).
Test the class you have written by going through the steps</p>
<ol class="simple">
<li><p>simulate data <span class="math notranslate nohighlight">\(X_1, \ldots, X_n\)</span> from distribution <span class="math notranslate nohighlight">\(\phi\)</span></p></li>
<li><p>plot the kernel density estimate over a suitable range</p></li>
<li><p>plot the density of <span class="math notranslate nohighlight">\(\phi\)</span> on the same figure</p></li>
</ol>
<p>for distributions <span class="math notranslate nohighlight">\(\phi\)</span> of the following types</p>
<ul class="simple">
<li><p>[beta distribution](https://en.wikipedia.org/wiki/Beta_distribution)
with <span class="math notranslate nohighlight">\(\alpha = \beta = 2\)</span></p></li>
<li><p>[beta distribution](https://en.wikipedia.org/wiki/Beta_distribution)
with <span class="math notranslate nohighlight">\(\alpha = 2\)</span> and <span class="math notranslate nohighlight">\(\beta = 5\)</span></p></li>
<li><p>[beta distribution](https://en.wikipedia.org/wiki/Beta_distribution)
with <span class="math notranslate nohighlight">\(\alpha = \beta = 0.5\)</span></p></li>
</ul>
<p>Use <span class="math notranslate nohighlight">\(n=500\)</span>.</p>
<p>Make a comment on your results. (Do you think this is a good estimator
of these distributions?)</p>
</div>
<div class="section" id="exercise-3">
<h3>Exercise 3<a class="headerlink" href="#exercise-3" title="Permalink to this headline">¶</a></h3>
<p>In the lecture we discussed the following fact: for the <span class="math notranslate nohighlight">\(AR(1)\)</span> process</p>
<p><div class="math notranslate nohighlight">
\[X_{t+1} = a X_t + b + c W_{t+1}\]</div>
</p>
<p>with <span class="math notranslate nohighlight">\(\{ W_t \}\)</span> iid and standard normal,</p>
<p><div class="math notranslate nohighlight">
\[\psi_t = N(\mu, s^2) \implies \psi_{t+1} 
= N(a \mu + b, a^2 s^2 + c^2)\]</div>
</p>
<p>Confirm this, at least approximately, by simulation. Let</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(a = 0.9\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(b = 0.0\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(c = 0.1\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\mu = -3\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(s = 0.2\)</span></p></li>
</ul>
<p>First, plot <span class="math notranslate nohighlight">\(\psi_t\)</span> and <span class="math notranslate nohighlight">\(\psi_{t+1}\)</span> using the true distributions
described above.</p>
<p>Second, plot <span class="math notranslate nohighlight">\(\psi_{t+1}\)</span> on the same figure (in a different color) as
follows:</p>
<ol class="simple">
<li><p>Generate <span class="math notranslate nohighlight">\(n\)</span> draws of <span class="math notranslate nohighlight">\(X_t\)</span> from the <span class="math notranslate nohighlight">\(N(\mu, s^2)\)</span> distribution</p></li>
<li><p>Update them all using the rule <span class="math notranslate nohighlight">\(X_{t+1} = a X_t + b + c W_{t+1}\)</span></p></li>
<li><p>Use the resulting sample of <span class="math notranslate nohighlight">\(X_{t+1}\)</span> values to produce a density
estimate via kernel density estimation.</p></li>
</ol>
<p>Try this for <span class="math notranslate nohighlight">\(n=2000\)</span> and confirm that the simulation based estimate of
<span class="math notranslate nohighlight">\(\psi_{t+1}\)</span> does converge to the theoretical distribution.</p>
</div>
</div>
<div class="section" id="solutions">
<h2><a class="toc-backref" href="#id11">Solutions</a><a class="headerlink" href="#solutions" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id2">
<h3>Exercise 1<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">njit</span>
<span class="kn">from</span> <span class="nn">scipy.special</span> <span class="kn">import</span> <span class="n">factorial2</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">sample_moments_ar1</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="mi">100_000</span><span class="p">,</span> <span class="n">mu_0</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">sigma_0</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">1234</span><span class="p">):</span>
    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
    <span class="n">sample_sum</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">mu_0</span> <span class="o">+</span> <span class="n">sigma_0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
        <span class="n">sample_sum</span> <span class="o">+=</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">mu_star</span><span class="p">)</span><span class="o">**</span><span class="n">k</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">a</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">b</span> <span class="o">+</span> <span class="n">c</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">sample_sum</span> <span class="o">/</span> <span class="n">m</span>

<span class="k">def</span> <span class="nf">true_moments_ar1</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">k</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">std_star</span><span class="o">**</span><span class="n">k</span> <span class="o">*</span> <span class="n">factorial2</span><span class="p">(</span><span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>

<span class="n">k_vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
<span class="n">sample_moments</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">k_vals</span><span class="p">)</span>
<span class="n">true_moments</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">k_vals</span><span class="p">)</span>

<span class="k">for</span> <span class="n">k_idx</span><span class="p">,</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">k_vals</span><span class="p">):</span>
    <span class="n">sample_moments</span><span class="p">[</span><span class="n">k_idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">sample_moments_ar1</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
    <span class="n">true_moments</span><span class="p">[</span><span class="n">k_idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">true_moments_ar1</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">k_vals</span><span class="p">,</span> <span class="n">true_moments</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;true moments&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">k_vals</span><span class="p">,</span> <span class="n">sample_moments</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;sample moments&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="id3">
<h3>Exercise 2<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<p>Here is one solution:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">K</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span>

<span class="k">class</span> <span class="nc">KDE</span><span class="p">:</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x_data</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

        <span class="k">if</span> <span class="n">h</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">x_data</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
            <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x_data</span><span class="p">)</span>
            <span class="n">h</span> <span class="o">=</span> <span class="mf">1.06</span> <span class="o">*</span> <span class="n">c</span> <span class="o">*</span> <span class="n">n</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">h</span> <span class="o">=</span> <span class="n">h</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x_data</span> <span class="o">=</span> <span class="n">x_data</span>

    <span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isscalar</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">K</span><span class="p">((</span><span class="n">x</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">x_data</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x_val</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
                <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">K</span><span class="p">((</span><span class="n">x_val</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">x_data</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">y</span>
</pre></div>
</div>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_kde</span><span class="p">(</span><span class="n">ϕ</span><span class="p">,</span> <span class="n">x_min</span><span class="o">=-</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">x_max</span><span class="o">=</span><span class="mf">1.2</span><span class="p">):</span>
    <span class="n">x_data</span> <span class="o">=</span> <span class="n">ϕ</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="n">kde</span> <span class="o">=</span> <span class="n">KDE</span><span class="p">(</span><span class="n">x_data</span><span class="p">)</span>

    <span class="n">x_grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_grid</span><span class="p">,</span> <span class="n">kde</span><span class="o">.</span><span class="n">f</span><span class="p">(</span><span class="n">x_grid</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;estimate&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_grid</span><span class="p">,</span> <span class="n">ϕ</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x_grid</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;true density&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">beta</span>

<span class="n">n</span> <span class="o">=</span> <span class="mi">500</span>
<span class="n">parameter_pairs</span><span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="k">for</span> <span class="n">α</span><span class="p">,</span> <span class="n">β</span> <span class="ow">in</span> <span class="n">parameter_pairs</span><span class="p">:</span>
    <span class="n">plot_kde</span><span class="p">(</span><span class="n">beta</span><span class="p">(</span><span class="n">α</span><span class="p">,</span> <span class="n">β</span><span class="p">))</span>
</pre></div>
</div>
<p>We see that the kernel density estimator is effective when the
underlying distribution is smooth but less so otherwise.</p>
</div>
<div class="section" id="id4">
<h3>Exercise 3<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<p>Here is our solution</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="mf">0.9</span>
<span class="n">b</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">c</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">μ</span> <span class="o">=</span> <span class="o">-</span><span class="mi">3</span>
<span class="n">s</span> <span class="o">=</span> <span class="mf">0.2</span>
</pre></div>
</div>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="n">μ_next</span> <span class="o">=</span> <span class="n">a</span> <span class="o">*</span> <span class="n">μ</span> <span class="o">+</span> <span class="n">b</span>
<span class="n">s_next</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">a</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">s</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">c</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="n">ψ</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">K</span><span class="p">((</span><span class="n">x</span> <span class="o">-</span> <span class="n">μ</span><span class="p">)</span> <span class="o">/</span> <span class="n">s</span><span class="p">)</span>
<span class="n">ψ_next</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">K</span><span class="p">((</span><span class="n">x</span> <span class="o">-</span> <span class="n">μ_next</span><span class="p">)</span> <span class="o">/</span> <span class="n">s_next</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="n">ψ</span> <span class="o">=</span> <span class="n">norm</span><span class="p">(</span><span class="n">μ</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
<span class="n">ψ_next</span> <span class="o">=</span> <span class="n">norm</span><span class="p">(</span><span class="n">μ_next</span><span class="p">,</span> <span class="n">s_next</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">2000</span>
<span class="n">x_draws</span> <span class="o">=</span> <span class="n">ψ</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">x_draws_next</span> <span class="o">=</span> <span class="n">a</span> <span class="o">*</span> <span class="n">x_draws</span> <span class="o">+</span> <span class="n">b</span> <span class="o">+</span> <span class="n">c</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">kde</span> <span class="o">=</span> <span class="n">KDE</span><span class="p">(</span><span class="n">x_draws_next</span><span class="p">)</span>

<span class="n">x_grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">μ</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">μ</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_grid</span><span class="p">,</span> <span class="n">ψ</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x_grid</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;$\psi_t$&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_grid</span><span class="p">,</span> <span class="n">ψ_next</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x_grid</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;$\psi_{t+1}$&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_grid</span><span class="p">,</span> <span class="n">kde</span><span class="o">.</span><span class="n">f</span><span class="p">(</span><span class="n">x_grid</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;estimate of $\psi_{t+1}$&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>The simulated distribution approximately coincides with the theoretical
distribution, as predicted.</p>
<p id="bibtex-bibliography-ar1_processes-MyST-0"><dl class="citation">
<dt class="bibtex label" id="meyntweedie2009"><span class="brackets"><a class="fn-backref" href="#id1">MT09</a></span></dt>
<dd><p>S P Meyn and R L Tweedie. <em>Markov Chains and Stochastic Stability</em>. Cambridge University Press, 2009.</p>
</dd>
</dl>
</p>
</div>
</div>
</div>


              </div>
              
              <div class='prev-next-bottom'>
                
    <a class='left-prev' id="prev-link" href="scalar_dynam-MyST.html" title="previous page"> Dynamics in One Dimension</a>

              </div>
              
          </main>

      </div>
    </div>

    <script src="_static/js/theme.js"></script>
    <footer class="footer">
  <div class="container">
    <p>
          &copy; Copyright 2020, Executable Book Project.<br/>
        Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.4.3.<br/>
    </p>
  </div>
</footer>
  </body>
</html>